#include "Utils.h"


//Prints the shellcode in the format of a traditional shellcode array
void print(const PUINT8 array, const SIZE_T size)
{
    printf("unsigned char Shellcode [] = {");

    for (int i = 0; i < size; i++)
    {

        if (i % 12 == 0)
        {
            printf_s("\n\t");
        }
        if (i < size - 1)
        {
            printf_s("0x%02X, ", array[i]);
        }
        else
        {
            printf_s("0x%02X\n", array[i]);
        }
    }

    printf_s("};\n\n\n");
}


//Custom implementation of memset
void memSet(__inout PVOID mem, __in const UINT8 setValue, __in SIZE_T length)
{
    SIZE_T it = 0;

    while (it < length)
    {
        ((volatile PUINT8)mem)[it] = setValue;
        it++;
    }
}


//Custom implementation of memcpy
void memCpy(__inout PVOID dest, __in const PVOID src, __in SIZE_T length)
{
    SIZE_T it = 0;

    while (it < length)
    {
        ((volatile PUINT8)dest)[it] = ((volatile PUINT8)src)[it];
        it++;
    }
}


//Custom implementation of XOR Encryption/Decryption
void encrpytDecrypt(__inout PUINT8 shellcode, __in const SIZE_T size)
{
    for (int i = 0; i < size; i++)
    {
        shellcode[i] = (shellcode[i] ^ XOR_KEY);
    }
}


